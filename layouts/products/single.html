{{ define "main" }}
<div class="container py-5">
    <!-- Кнопка возврата -->
    <div class="mb-4">
        <a href="{{ "products/" | relURL }}" class="btn btn-outline-danger">
            <i class="fas fa-arrow-left me-2"></i>Назад к каталогу
        </a>
    </div>

    <!-- Заголовок продукта -->
    <div class="mb-5">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <div class="mb-3">
                    {{ if .Params.categories }}
                    {{ range .Params.categories }}
                    <span class="badge bg-danger bg-opacity-10 text-danger border border-danger me-2">
                        <i class="fas fa-tag me-1"></i>{{ partial "category-title.html" (. | lower) }}
                    </span>
                    {{ end }}
                    {{ end }}
                </div>
                
                <h1 class="display-5 fw-bold mb-3">{{ .Params.Title | default .Title }}</h1>
                
                <div class="mb-4">
                    <span class="text-muted me-3">
                        <i class="fas fa-cube me-2"></i><strong>Модель:</strong> {{ .Title }}
                    </span>
                    {{ if .Params.partNumber }}
                    <span class="text-muted">
                        <i class="fas fa-barcode me-2"></i><strong>Артикул:</strong> {{ .Params.partNumber }}
                    </span>
                    {{ end }}
                </div>

                {{ if .Params.applications }}
                <div class="mb-4">
                    <h6 class="fw-bold mb-3">
                        <i class="fas fa-industry me-2 text-danger"></i>Области применения:
                    </h6>
                    <div class="d-flex flex-wrap gap-2">
                        {{ range .Params.applications }}
                        <span class="badge bg-light text-dark border px-3 py-2">
                            <i class="fas fa-check-circle me-1 text-success"></i>{{ . }}
                        </span>
                        {{ end }}
                    </div>
                </div>
                {{ end }}
            </div>
            
            <div class="col-lg-4">
                {{ if .Params.images }}
                <div class="position-relative">
                    {{ $firstImage := index .Params.images 0 }}
                    <img src="{{ printf "img/products/%s" $firstImage | relURL }}"
                         alt="{{ .Title }}"
                         class="img-fluid rounded-3 shadow-lg w-100 bg-light p-3"
                         style="max-height: 350px; object-fit: contain; cursor: pointer;"
                         onclick="openImageModal(this.src, '{{ .Title }}')">
                    <div class="position-absolute bottom-0 end-0 m-3">
                        <span class="badge bg-dark bg-opacity-75">
                            <i class="fas fa-search-plus me-1"></i>Увеличить
                        </span>
                    </div>
                </div>
                {{ else }}
                <div class="d-flex align-items-center justify-content-center rounded-3 shadow bg-light" style="height: 350px;">
                    <div class="text-center">
                        <i class="fas fa-microchip fa-4x text-muted mb-3"></i>
                        <p class="text-muted">Изображение скоро появится</p>
                    </div>
                </div>
                {{ end }}
            </div>
        </div>
    </div>



    <div class="row">
        <div class="col-lg-8">
            <!-- Содержимое страницы -->
            <div class="mb-5">
                {{ .Content }}
            </div>
        </div>

        <div class="col-lg-4">
            <!-- Карточка связи -->
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-4">
                    <div class="text-center mb-4">
                        <div class="bg-danger bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
                             style="width: 80px; height: 80px;">
                            <i class="fas fa-headset fa-2x text-danger"></i>
                        </div>
                        <h5 class="card-title fw-bold">Получить консультацию</h5>
                        <p class="card-text text-muted small">Свяжитесь с нами для получения подробной информации о продукте и условиях поставки.</p>
                    </div>
                    <a href="{{ "contacts/" | relURL }}" class="btn btn-danger w-100 mb-2">
                        <i class="fas fa-phone me-2"></i>Связаться с нами
                    </a>
                    <a href="mailto:{{ .Site.Params.company.email }}" class="btn btn-outline-danger w-100">
                        <i class="fas fa-envelope me-2"></i>Написать Email
                    </a>
                </div>
            </div>

            <!-- Быстрые факты -->
            <div class="card border-0 shadow-sm mb-4 bg-light">
                <div class="card-body p-4">
                    <h6 class="fw-bold mb-3">
                        <i class="fas fa-check-circle me-2 text-success"></i>Преимущества
                    </h6>
                    <ul class="list-unstyled mb-0 small">
                        <li class="mb-2">
                            <i class="fas fa-award text-warning me-2"></i>Собственное производство
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-tools text-primary me-2"></i>Техническая поддержка
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-shield-alt text-success me-2"></i>Гарантия качества
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-truck text-info me-2"></i>Доставка по России
                        </li>
                        <li class="mb-0">
                            <i class="fas fa-cog text-danger me-2"></i>Индивидуальные решения
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Похожие продукты -->
            {{ $related := .Site.RegularPages.Related . | first 3 }}
            {{ if $related }}
            <div class="card border-0 shadow-sm">
                <div class="card-body p-4">
                    <h6 class="card-title fw-bold mb-3">
                        <i class="fas fa-cubes me-2 text-danger"></i>Похожие продукты
                    </h6>
                    {{ range $related }}
                    <div class="mb-3 pb-3 {{ if not (eq . (index $related 2)) }}border-bottom{{ end }}">
                        <a href="{{ .RelPermalink }}" class="text-decoration-none">
                            <h6 class="mb-1 text-danger">{{ .Title }}</h6>
                            <small class="text-muted">{{ .Params.fullName | default .Title }}</small>
                        </a>
                    </div>
                    {{ end }}
                    <a href="{{ "products/" | relURL }}" class="btn btn-sm btn-outline-danger w-100 mt-2">
                        <i class="fas fa-th me-2"></i>Все продукты
                    </a>
                </div>
            </div>
            {{ end }}
        </div>
    </div>

    <!-- Призыв к действию -->
    <div class="row mt-5 pt-5 border-top">
        <div class="col-12">
            <div class="card border-0 shadow-sm text-white" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);">
                <div class="card-body p-5 text-center">
                    <i class="fas fa-file-alt fa-3x mb-4 opacity-75"></i>
                    <h3 class="fw-bold mb-3">Нужна техническая документация?</h3>
                    <p class="lead mb-4 opacity-90">
                        Получите полную техническую документацию, спецификации и руководства по эксплуатации
                    </p>
                    <div class="d-flex gap-3 justify-content-center flex-wrap">
                        <a href="{{ "contacts/" | relURL }}" class="btn btn-light btn-lg">
                            <i class="fas fa-download me-2"></i>Запросить документацию
                        </a>
                        <a href="{{ "products/" | relURL }}" class="btn btn-outline-light btn-lg">
                            <i class="fas fa-arrow-left me-2"></i>К каталогу продуктов
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Image Modal -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg">
            <div class="modal-header border-0">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center p-4 bg-light">
                <img id="modalImage" src="" alt="" class="img-fluid rounded shadow">
            </div>
        </div>
    </div>
</div>

<script>
function openImageModal(imageSrc, imageAlt) {
    const modal = new bootstrap.Modal(document.getElementById('imageModal'));
    const modalImage = document.getElementById('modalImage');
    modalImage.src = imageSrc;
    modalImage.alt = imageAlt;
    modal.show();
}
</script>
{{ end }}
